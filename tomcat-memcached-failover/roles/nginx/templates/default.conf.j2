upstream tomcat  {
{% for host in groups['webservers'] %}
      server {{ host }}:{{ tomcat_http_port }};
{% endfor %}

{% for host in groups['webservers'] %}
      server {{ host }}:{{ tomcat_https_port }};
{% endfor %}
}

server {
    listen       80 default_server;
    server_name  {{ inventory_hostname }};
    include /etc/nginx/default.d/*.conf;

    location / {
      proxy_pass http://tomcat;
    }

    listen       443 default_server;
    server_name  {{ inventory_hostname }};
    include /etc/nginx/default.d/*.conf;

    location / {
      proxy_pass https://tomcat;
    }
}


